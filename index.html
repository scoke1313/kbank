// --- 물리 파라미터 미세 조정 ---
const PHYSICS = {
    gravity: 1.0,       // 중력을 0.9 -> 1.0으로 높여 더 묵직하게 낙하
    jumpPower: -23,     // 도약력을 -20 -> -23으로 높여 튕겨나가는 탄성 강화
    moveSpeed: 7,
    stageWidth: 393,
    stageHeight: 852,
    motionHold: 15      // 1번 모션 유지 시간을 12 -> 15프레임으로 늘려 도약감 강조
};

// ... (기존 코드 생략) ...

function update() {
    // (이동 및 가속도 계산 로직 동일)
    velocityY += PHYSICS.gravity;
    currentY += velocityY;

    // (모션 제어 로직 동일)

    // 4. [수정] 밟는 느낌을 극대화한 히트박스 판정
    if (velocityY > 0) { // 하강 중에만 판정
        platforms.forEach(p => {
            // 춘식이 발 위치 (이미지 하단부)
            const charFoot = (852 - 100 - currentY);
            
            // 춘식이 가로 범위 (더 타이트하게 조정)
            const charLeft = (PHYSICS.stageWidth / 2) + posX - 20;
            const charRight = (PHYSICS.stageWidth / 2) + posX + 20;

            // [핵심 수정] 
            // 1. 발판의 윗면(p.y)보다 발이 '약간 더 아래로' 내려왔을 때 판정 (파묻히는 느낌)
            // 2. 판정 오차 범위를 좁혀서(15px -> 10px) 정확히 밟았을 때만 반응
            if (charRight > p.x && charLeft < p.x + 80) {
                if (charFoot >= p.y + 2 && charFoot <= p.y + 12) {
                    
                    // 밟는 순간의 물리적 반동 시각화
                    velocityY = PHYSICS.jumpPower; 
                    motionTimer = PHYSICS.motionHold; 
                    
                    // 밟는 순간 살짝 '멈칫'하는 느낌을 주려면 currentY를 보정
                    currentY -= 5; // 밟는 순간 위로 5px 강제 이동 (반동 강조)
                    
                    loadRive('kongsik_ingame_air.riv');
                    console.log("발판 딛음!");
                }
            }
        });
    }

    // (나머지 렌더링 로직 동일)
}
